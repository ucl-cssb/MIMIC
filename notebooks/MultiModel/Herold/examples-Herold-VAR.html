<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>VAR inference on a Real Public Dataset, Herold et al. (2020) &#8212; MIMIC 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="../../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Sparse VAR on a Real Public Dataset, Herold et al. (2020)" href="examples-Herold-sVAR.html" />
    <link rel="prev" title="MVAR Simulation for Microbiota and Metabolites" href="../../MVAR/examples-sim-MVAR.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="VAR-inference-on-a-Real-Public-Dataset,-Herold-et-al.-(2020)">
<h1>VAR inference on a Real Public Dataset, Herold et al. (2020)<a class="headerlink" href="#VAR-inference-on-a-Real-Public-Dataset,-Herold-et-al.-(2020)" title="Link to this heading">¶</a></h1>
<p>In this example, we will be using the GP imputator on a dataset available at <a class="reference external" href="https://doi.org/10.1038/s41467-020-19006-2">Herold et al., 2020</a> to imputate missing data. Then, we are going to use the VAR inference method to infer the causal relationships between the variables in the time series.</p>
<p>First, we will import the neccessary libraries and load the dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>


<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>


<span class="kn">from</span><span class="w"> </span><span class="nn">mimic.data_imputation.impute_GP</span><span class="w"> </span><span class="kn">import</span> <span class="n">GPImputer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mimic.model_infer.infer_VAR_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
WARNING:tensorflow:From c:\ProgramData\anaconda3\envs\MIMIC\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From c:\ProgramData\anaconda3\envs\MIMIC\Lib\site-packages\tensorflow_probability\python\internal\backend\numpy\_utils.py:48: The name tf.logging.TaskLevelStatusMessage is deprecated. Please use tf.compat.v1.logging.TaskLevelStatusMessage instead.

WARNING:tensorflow:From c:\ProgramData\anaconda3\envs\MIMIC\Lib\site-packages\tensorflow_probability\python\internal\backend\numpy\_utils.py:48: The name tf.control_flow_v2_enabled is deprecated. Please use tf.compat.v1.control_flow_v2_enabled instead.

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reload the imputed data into a new DataFrame</span>

<span class="n">imputed_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;imputed_data.csv&#39;</span><span class="p">)</span>

<span class="n">imputed_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>days</th>
      <th>Acidimicrobium</th>
      <th>Acinetobacter</th>
      <th>Albidiferax</th>
      <th>Candidatus Microthrix</th>
      <th>Chitinophaga pinensis</th>
      <th>Dechloromonas</th>
      <th>Haliscomenobacter</th>
      <th>Intrasporangium</th>
      <th>Leptospira</th>
      <th>Other</th>
      <th>Xanthomonas</th>
      <th>mean abundance &lt; 2%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>8.322484</td>
      <td>0.791870</td>
      <td>6.383491</td>
      <td>26.180838</td>
      <td>7.055585</td>
      <td>4.998287</td>
      <td>15.142620</td>
      <td>11.445072</td>
      <td>4.742982</td>
      <td>2.357318</td>
      <td>0.853658</td>
      <td>11.725795</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>8.265177</td>
      <td>0.763703</td>
      <td>6.362575</td>
      <td>25.593890</td>
      <td>7.081694</td>
      <td>5.072711</td>
      <td>15.397948</td>
      <td>11.546582</td>
      <td>4.791269</td>
      <td>2.382206</td>
      <td>0.864697</td>
      <td>11.836536</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>8.180701</td>
      <td>0.781881</td>
      <td>6.330330</td>
      <td>25.226861</td>
      <td>7.127157</td>
      <td>5.147886</td>
      <td>15.663537</td>
      <td>11.636934</td>
      <td>4.833619</td>
      <td>2.399779</td>
      <td>0.879132</td>
      <td>11.947293</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>8.078737</td>
      <td>0.801890</td>
      <td>6.290243</td>
      <td>24.849371</td>
      <td>7.185821</td>
      <td>5.219273</td>
      <td>15.926969</td>
      <td>11.710476</td>
      <td>4.868031</td>
      <td>2.418784</td>
      <td>0.894873</td>
      <td>12.058067</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.0</td>
      <td>7.969807</td>
      <td>0.823758</td>
      <td>6.246734</td>
      <td>24.505012</td>
      <td>7.249498</td>
      <td>5.280679</td>
      <td>16.172482</td>
      <td>11.759176</td>
      <td>4.892380</td>
      <td>2.438263</td>
      <td>0.909303</td>
      <td>12.168858</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5.0</td>
      <td>7.863614</td>
      <td>0.847488</td>
      <td>6.204391</td>
      <td>24.245813</td>
      <td>7.309111</td>
      <td>5.324508</td>
      <td>16.382314</td>
      <td>11.772278</td>
      <td>4.904550</td>
      <td>2.457029</td>
      <td>0.919595</td>
      <td>12.279667</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6.0</td>
      <td>7.770084</td>
      <td>0.873055</td>
      <td>6.167656</td>
      <td>24.127242</td>
      <td>7.355842</td>
      <td>5.342460</td>
      <td>16.538718</td>
      <td>11.737040</td>
      <td>4.902619</td>
      <td>2.473734</td>
      <td>0.923138</td>
      <td>12.390494</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7.0</td>
      <td>7.700314</td>
      <td>0.900405</td>
      <td>6.140528</td>
      <td>24.199845</td>
      <td>7.382293</td>
      <td>5.326927</td>
      <td>16.626579</td>
      <td>11.641157</td>
      <td>4.885061</td>
      <td>2.487002</td>
      <td>0.918012</td>
      <td>12.501338</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8.0</td>
      <td>7.664534</td>
      <td>0.911291</td>
      <td>6.125822</td>
      <td>23.641355</td>
      <td>7.383681</td>
      <td>5.273044</td>
      <td>16.636265</td>
      <td>11.476739</td>
      <td>4.850959</td>
      <td>2.520630</td>
      <td>0.903478</td>
      <td>12.612201</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9.0</td>
      <td>7.666801</td>
      <td>0.960073</td>
      <td>6.124129</td>
      <td>25.024940</td>
      <td>7.358852</td>
      <td>5.180566</td>
      <td>16.565955</td>
      <td>11.244474</td>
      <td>4.800196</td>
      <td>2.499159</td>
      <td>0.880339</td>
      <td>12.321359</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10.0</td>
      <td>7.701597</td>
      <td>0.992116</td>
      <td>6.133189</td>
      <td>25.753165</td>
      <td>7.310707</td>
      <td>5.055128</td>
      <td>16.422573</td>
      <td>10.955857</td>
      <td>4.733611</td>
      <td>2.497398</td>
      <td>0.851104</td>
      <td>12.030537</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11.0</td>
      <td>7.756540</td>
      <td>1.025393</td>
      <td>6.148177</td>
      <td>26.621835</td>
      <td>7.245802</td>
      <td>4.907436</td>
      <td>16.220878</td>
      <td>10.632238</td>
      <td>4.653122</td>
      <td>2.490776</td>
      <td>0.819790</td>
      <td>11.739731</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12.0</td>
      <td>7.816900</td>
      <td>1.059680</td>
      <td>6.162504</td>
      <td>27.550701</td>
      <td>7.173270</td>
      <td>4.751605</td>
      <td>15.981051</td>
      <td>10.301403</td>
      <td>4.561808</td>
      <td>2.479674</td>
      <td>0.791448</td>
      <td>11.448942</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13.0</td>
      <td>7.867041</td>
      <td>1.094721</td>
      <td>6.168573</td>
      <td>28.452806</td>
      <td>7.103389</td>
      <td>4.602845</td>
      <td>15.725567</td>
      <td>9.993155</td>
      <td>4.463977</td>
      <td>2.464200</td>
      <td>0.771427</td>
      <td>11.158170</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14.0</td>
      <td>7.890203</td>
      <td>1.130229</td>
      <td>6.158709</td>
      <td>29.247651</td>
      <td>7.046066</td>
      <td>4.475146</td>
      <td>15.476159</td>
      <td>9.734647</td>
      <td>4.365213</td>
      <td>2.444171</td>
      <td>0.764505</td>
      <td>10.867413</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>And we can run the VAR inference method to infer the causal relationships between the variables in the time series.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">infer</span> <span class="o">=</span> <span class="n">infer_VAR</span><span class="p">(</span><span class="n">imputed_data</span><span class="p">)</span>
<span class="n">infer</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="s1">&#39;high&#39;</span>

<span class="n">infer</span><span class="o">.</span><span class="n">run_inference</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [noise_stddev, x0, c2, tau, lam, A, noise_chol]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
    <style>
        /* Turns off some styling */
        progress {
            /* gets rid of default border in Firefox and Opera. */
            border: none;
            /* Needs to be in here for Safari polyfill so background images work as expected. */
            background-size: auto;
        }
        .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
            background: #F44336;
        }
    </style>
  <progress value='24000' class='' max='24000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [24000/24000 1:12:47<00:00 Sampling 4 chains, 2,793 divergences]
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Sampling 4 chains for 2_000 tune and 4_000 draw iterations (8_000 + 16_000 draws total) took 4378 seconds.
There were 2793 divergences after tuning. Increase `target_accept` or reparameterize.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
            mean     sd  hdi_3%  hdi_97%  mcse_mean  mcse_sd  ess_bulk  \
A[0, 0]    1.000  0.000   1.000    1.000        0.0      0.0    2830.0
A[0, 1]    0.011  0.001   0.009    0.012        0.0      0.0    3568.0
A[0, 2]    0.010  0.000   0.010    0.011        0.0      0.0    2935.0
A[0, 3]    0.008  0.001   0.007    0.009        0.0      0.0    3297.0
A[0, 4]    0.010  0.000   0.010    0.011        0.0      0.0    4357.0
...          ...    ...     ...      ...        ...      ...       ...
A[12, 8]   0.006  0.004  -0.001    0.014        0.0      0.0    3223.0
A[12, 9]   0.015  0.003   0.010    0.020        0.0      0.0    3712.0
A[12, 10] -0.100  0.019  -0.136   -0.063        0.0      0.0    4900.0
A[12, 11]  0.004  0.012  -0.017    0.029        0.0      0.0    2895.0
A[12, 12]  1.009  0.006   0.998    1.021        0.0      0.0    2357.0

           ess_tail  r_hat
A[0, 0]      1838.0    1.0
A[0, 1]      3593.0    1.0
A[0, 2]      3814.0    1.0
A[0, 3]      1944.0    1.0
A[0, 4]      3382.0    1.0
...             ...    ...
A[12, 8]     2983.0    1.0
A[12, 9]     4507.0    1.0
A[12, 10]    7963.0    1.0
A[12, 11]    2195.0    1.0
A[12, 12]    2534.0    1.0

[169 rows x 9 columns]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\ProgramData\anaconda3\envs\MIMIC\Lib\site-packages\arviz\plots\plot_utils.py:271: UserWarning: rcParams[&#39;plot.max_subplots&#39;] (40) is smaller than the number of variables to plot (169) in plot_posterior, generating only 40 plots
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Results saved as:
NetCDF file: model_posterior_large_v2.nc
Data file: data_large_v2.npz
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_MultiModel_Herold_examples-Herold-VAR_6_6.png" src="../../../_images/notebooks_MultiModel_Herold_examples-Herold-VAR_6_6.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">infer</span><span class="o">.</span><span class="n">posterior_analysis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_MultiModel_Herold_examples-Herold-VAR_7_0.png" src="../../../_images/notebooks_MultiModel_Herold_examples-Herold-VAR_7_0.png" />
</div>
</div>
<p>The results show an improvement (as seen by the r_hat values). However, if we look at the posterior distributions, some of them are wide, others are skewed, and some are multimodal. This indicates that the model is not a good fit for the data. Therefore, we are going to try different methods to improve the inference results.</p>
<p>First, we will test to see if the data is stationary or not using the <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> package.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now we are going to check for stationarity in the data using adf and kpss tests from stasmodels library</span>
<span class="c1"># We will use the imputed data set</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.stattools</span><span class="w"> </span><span class="kn">import</span> <span class="n">adfuller</span><span class="p">,</span> <span class="n">kpss</span>


<span class="k">def</span><span class="w"> </span><span class="nf">adf_test</span><span class="p">(</span><span class="n">timeseries</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Results of Dickey-Fuller Test:&quot;</span><span class="p">)</span>
    <span class="n">dftest</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">timeseries</span><span class="p">,</span> <span class="n">autolag</span><span class="o">=</span><span class="s2">&quot;AIC&quot;</span><span class="p">)</span>
    <span class="n">dfoutput</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
        <span class="n">dftest</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span>
        <span class="n">index</span><span class="o">=</span><span class="p">[</span>
            <span class="s2">&quot;Test Statistic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;p-value&quot;</span><span class="p">,</span>
            <span class="s2">&quot;#Lags Used&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Number of Observations Used&quot;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dftest</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">dfoutput</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Critical Value (</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dfoutput</span><span class="p">)</span>
    <span class="c1"># if p-value is less than 0.05, we reject the null hypothesis and say that the data is stationary</span>
    <span class="c1"># print if the data is stationary or not</span>
    <span class="k">if</span> <span class="n">dftest</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ADF Test: Data is stationary&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ADF Test: Data is not stationary&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">kpss_test</span><span class="p">(</span><span class="n">timeseries</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Results of KPSS Test:&quot;</span><span class="p">)</span>
    <span class="n">kpsstest</span> <span class="o">=</span> <span class="n">kpss</span><span class="p">(</span><span class="n">timeseries</span><span class="p">,</span> <span class="n">regression</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
    <span class="n">kpss_output</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
        <span class="n">kpsstest</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Test Statistic&quot;</span><span class="p">,</span> <span class="s2">&quot;p-value&quot;</span><span class="p">,</span> <span class="s2">&quot;Lags Used&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kpsstest</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">kpss_output</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Critical Value (</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">kpss_output</span><span class="p">)</span>
    <span class="c1"># if p-value is greater than 0.05, we reject the null hypothesis and say that the data is stationary</span>
    <span class="c1"># print if the data is stationary or not</span>
    <span class="k">if</span> <span class="n">kpsstest</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;KPSS test: Data is stationary&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;KPSS test: Data is not stationary&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check for stationarity in the data imputed_dataset (without the &#39;days&#39; column)</span>
<span class="n">imputed_data_reduced_no_days</span> <span class="o">=</span> <span class="n">imputed_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;days&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">genus</span> <span class="ow">in</span> <span class="n">imputed_data_reduced_no_days</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">genus</span><span class="p">)</span>
    <span class="n">adf_test</span><span class="p">(</span><span class="n">imputed_data_reduced_no_days</span><span class="p">[</span><span class="n">genus</span><span class="p">])</span>
    <span class="n">kpss_test</span><span class="p">(</span><span class="n">imputed_data_reduced_no_days</span><span class="p">[</span><span class="n">genus</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Acidimicrobium
Results of Dickey-Fuller Test:
Test Statistic                  -2.694583
p-value                          0.074980
#Lags Used                      17.000000
Number of Observations Used    392.000000
Critical Value (1%)             -3.447142
Critical Value (5%)             -2.868941
Critical Value (10%)            -2.570713
dtype: float64
ADF Test: Data is not stationary
Results of KPSS Test:
Test Statistic            0.181567
p-value                   0.100000
Lags Used                12.000000
Critical Value (10%)      0.347000
Critical Value (5%)       0.463000
Critical Value (2.5%)     0.574000
Critical Value (1%)       0.739000
dtype: float64
KPSS test: Data is stationary


Acinetobacter
Results of Dickey-Fuller Test:
Test Statistic                  -1.760882
p-value                          0.400048
#Lags Used                      18.000000
Number of Observations Used    391.000000
Critical Value (1%)             -3.447186
Critical Value (5%)             -2.868960
Critical Value (10%)            -2.570723
dtype: float64
ADF Test: Data is not stationary
Results of KPSS Test:
Test Statistic            0.538580
p-value                   0.032977
Lags Used                12.000000
Critical Value (10%)      0.347000
Critical Value (5%)       0.463000
Critical Value (2.5%)     0.574000
Critical Value (1%)       0.739000
dtype: float64
KPSS test: Data is not stationary


Albidiferax
Results of Dickey-Fuller Test:
Test Statistic                  -3.230973
p-value                          0.018260
#Lags Used                      12.000000
Number of Observations Used    397.000000
Critical Value (1%)             -3.446930
Critical Value (5%)             -2.868848
Critical Value (10%)            -2.570663
dtype: float64
ADF Test: Data is stationary
Results of KPSS Test:
Test Statistic            0.18977
p-value                   0.10000
Lags Used                12.00000
Critical Value (10%)      0.34700
Critical Value (5%)       0.46300
Critical Value (2.5%)     0.57400
Critical Value (1%)       0.73900
dtype: float64
KPSS test: Data is stationary


Candidatus Microthrix
Results of Dickey-Fuller Test:
Test Statistic                  -1.670607
p-value                          0.446317
#Lags Used                       9.000000
Number of Observations Used    400.000000
Critical Value (1%)             -3.446804
Critical Value (5%)             -2.868793
Critical Value (10%)            -2.570634
dtype: float64
ADF Test: Data is not stationary
Results of KPSS Test:
Test Statistic            0.491153
p-value                   0.043659
Lags Used                12.000000
Critical Value (10%)      0.347000
Critical Value (5%)       0.463000
Critical Value (2.5%)     0.574000
Critical Value (1%)       0.739000
dtype: float64
KPSS test: Data is not stationary


Chitinophaga pinensis
Results of Dickey-Fuller Test:
Test Statistic                  -3.656258
p-value                          0.004772
#Lags Used                      18.000000
Number of Observations Used    391.000000
Critical Value (1%)             -3.447186
Critical Value (5%)             -2.868960
Critical Value (10%)            -2.570723
dtype: float64
ADF Test: Data is stationary
Results of KPSS Test:
Test Statistic            0.147337
p-value                   0.100000
Lags Used                12.000000
Critical Value (10%)      0.347000
Critical Value (5%)       0.463000
Critical Value (2.5%)     0.574000
Critical Value (1%)       0.739000
dtype: float64
KPSS test: Data is stationary


Dechloromonas
Results of Dickey-Fuller Test:
Test Statistic                  -2.007589
p-value                          0.283256
#Lags Used                      16.000000
Number of Observations Used    393.000000
Critical Value (1%)             -3.447099
Critical Value (5%)             -2.868923
Critical Value (10%)            -2.570703
dtype: float64
ADF Test: Data is not stationary
Results of KPSS Test:
Test Statistic            2.066558
p-value                   0.010000
Lags Used                12.000000
Critical Value (10%)      0.347000
Critical Value (5%)       0.463000
Critical Value (2.5%)     0.574000
Critical Value (1%)       0.739000
dtype: float64
KPSS test: Data is not stationary


Haliscomenobacter
Results of Dickey-Fuller Test:
Test Statistic                  -3.263321
p-value                          0.016600
#Lags Used                      18.000000
Number of Observations Used    391.000000
Critical Value (1%)             -3.447186
Critical Value (5%)             -2.868960
Critical Value (10%)            -2.570723
dtype: float64
ADF Test: Data is stationary
Results of KPSS Test:
Test Statistic            1.771421
p-value                   0.010000
Lags Used                12.000000
Critical Value (10%)      0.347000
Critical Value (5%)       0.463000
Critical Value (2.5%)     0.574000
Critical Value (1%)       0.739000
dtype: float64
KPSS test: Data is not stationary


Intrasporangium
Results of Dickey-Fuller Test:
Test Statistic                  -1.606400
p-value                          0.480378
#Lags Used                      17.000000
Number of Observations Used    392.000000
Critical Value (1%)             -3.447142
Critical Value (5%)             -2.868941
Critical Value (10%)            -2.570713
dtype: float64
ADF Test: Data is not stationary
Results of KPSS Test:
Test Statistic            0.819306
p-value                   0.010000
Lags Used                12.000000
Critical Value (10%)      0.347000
Critical Value (5%)       0.463000
Critical Value (2.5%)     0.574000
Critical Value (1%)       0.739000
dtype: float64
KPSS test: Data is not stationary


Leptospira
Results of Dickey-Fuller Test:
Test Statistic                  -2.285039
p-value                          0.176839
#Lags Used                      18.000000
Number of Observations Used    391.000000
Critical Value (1%)             -3.447186
Critical Value (5%)             -2.868960
Critical Value (10%)            -2.570723
dtype: float64
ADF Test: Data is not stationary
Results of KPSS Test:
Test Statistic            0.165134
p-value                   0.100000
Lags Used                12.000000
Critical Value (10%)      0.347000
Critical Value (5%)       0.463000
Critical Value (2.5%)     0.574000
Critical Value (1%)       0.739000
dtype: float64
KPSS test: Data is stationary


Other
Results of Dickey-Fuller Test:
Test Statistic                  -1.747569
p-value                          0.406785
#Lags Used                       7.000000
Number of Observations Used    402.000000
Critical Value (1%)             -3.446722
Critical Value (5%)             -2.868757
Critical Value (10%)            -2.570614
dtype: float64
ADF Test: Data is not stationary
Results of KPSS Test:
Test Statistic            0.514436
p-value                   0.038415
Lags Used                12.000000
Critical Value (10%)      0.347000
Critical Value (5%)       0.463000
Critical Value (2.5%)     0.574000
Critical Value (1%)       0.739000
dtype: float64
KPSS test: Data is not stationary


Xanthomonas
Results of Dickey-Fuller Test:
Test Statistic                  -2.371457
p-value                          0.149955
#Lags Used                      16.000000
Number of Observations Used    393.000000
Critical Value (1%)             -3.447099
Critical Value (5%)             -2.868923
Critical Value (10%)            -2.570703
dtype: float64
ADF Test: Data is not stationary
Results of KPSS Test:
Test Statistic            0.610083
p-value                   0.021720
Lags Used                12.000000
Critical Value (10%)      0.347000
Critical Value (5%)       0.463000
Critical Value (2.5%)     0.574000
Critical Value (1%)       0.739000
dtype: float64
KPSS test: Data is not stationary


mean abundance &lt; 2%
Results of Dickey-Fuller Test:
Test Statistic                  -1.335809
p-value                          0.612635
#Lags Used                       8.000000
Number of Observations Used    401.000000
Critical Value (1%)             -3.446763
Critical Value (5%)             -2.868775
Critical Value (10%)            -2.570624
dtype: float64
ADF Test: Data is not stationary
Results of KPSS Test:
Test Statistic            1.449163
p-value                   0.010000
Lags Used                12.000000
Critical Value (10%)      0.347000
Critical Value (5%)       0.463000
Critical Value (2.5%)     0.574000
Critical Value (1%)       0.739000
dtype: float64
KPSS test: Data is not stationary


</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\Users\User\AppData\Local\Temp\ipykernel_43880\3039934652.py:33: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpsstest = kpss(timeseries, regression=&#34;c&#34;, nlags=&#34;auto&#34;)
C:\Users\User\AppData\Local\Temp\ipykernel_43880\3039934652.py:33: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpsstest = kpss(timeseries, regression=&#34;c&#34;, nlags=&#34;auto&#34;)
C:\Users\User\AppData\Local\Temp\ipykernel_43880\3039934652.py:33: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpsstest = kpss(timeseries, regression=&#34;c&#34;, nlags=&#34;auto&#34;)
C:\Users\User\AppData\Local\Temp\ipykernel_43880\3039934652.py:33: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is smaller than the p-value returned.

  kpsstest = kpss(timeseries, regression=&#34;c&#34;, nlags=&#34;auto&#34;)
C:\Users\User\AppData\Local\Temp\ipykernel_43880\3039934652.py:33: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is smaller than the p-value returned.

  kpsstest = kpss(timeseries, regression=&#34;c&#34;, nlags=&#34;auto&#34;)
C:\Users\User\AppData\Local\Temp\ipykernel_43880\3039934652.py:33: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is smaller than the p-value returned.

  kpsstest = kpss(timeseries, regression=&#34;c&#34;, nlags=&#34;auto&#34;)
C:\Users\User\AppData\Local\Temp\ipykernel_43880\3039934652.py:33: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is greater than the p-value returned.

  kpsstest = kpss(timeseries, regression=&#34;c&#34;, nlags=&#34;auto&#34;)
C:\Users\User\AppData\Local\Temp\ipykernel_43880\3039934652.py:33: InterpolationWarning: The test statistic is outside of the range of p-values available in the
look-up table. The actual p-value is smaller than the p-value returned.

  kpsstest = kpss(timeseries, regression=&#34;c&#34;, nlags=&#34;auto&#34;)
</pre></div></div>
</div>
<p>These tests results show that most of the genus’ samples is not stationary, which means that the data is not homoscedastic. This is a common problem in microbiome data, where the variance of the data is not constant across the samples. This is a problem for most imputation methods, as they assume that the data is homoscedastic.</p>
<p>To change this, we will be using a detrending method to make the data stationary by differencing the data. This will allow us to use the VAR inference method to impute the parameters of interaction.</p>
<p>It is one of the simplest methods for detrending a time series. A new series is constructed where the value at the current time step is calculated as the difference between the original observation and the observation at the previous time step.</p>
<p>We can see the results of inferring the differenciated data. The results are not much better than before. So now, we are going to try one last method to improve the inference results. We are going use <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> to infer the relationships between the variables in the time series using a VAR model, then use the predicted posterior distributions as priors for the inference method and observe the results.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">VAR</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a pandas dataframe of the original imputed data_set with days as the index</span>
<span class="n">imputed_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;days&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make VAR model with the imputed data set and statsmodels library</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">VAR</span><span class="p">(</span><span class="n">imputed_data</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">maxlags</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\ProgramData\anaconda3\envs\MIMIC\Lib\site-packages\statsmodels\tsa\base\tsa_model.py:473: ValueWarning: An unsupported index was provided and will be ignored when e.g. forecasting.
  self._init_dates(dates, freq)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coefficients</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span>
<span class="n">covariance_matrix</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">sigma_u</span>
<span class="n">intercepts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># remove the first row of the coefficients matrix</span>
<span class="n">coefficients</span> <span class="o">=</span> <span class="n">coefficients</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="c1"># transpose the coefficients matrix</span>
<span class="n">coefficients</span> <span class="o">=</span> <span class="n">coefficients</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<p>As we can see, the results are much better than before. This is because bayesian VAR inference method works much better with the predicted posterior distributions as priors. This is because the predicted posterior distributions offer a better estimate of the parameters of interaction between the variables in the time series which the bayesian VAR inference method can use to infer the causal relationships between the variables in the time series.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># do the same for run_inference_large</span>
<span class="n">infer9</span> <span class="o">=</span> <span class="n">infer_VAR</span><span class="p">(</span><span class="n">imputed_data</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">,</span> <span class="n">intercepts</span><span class="p">,</span> <span class="n">covariance_matrix</span><span class="p">)</span>
<span class="n">infer9</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span>
<span class="n">infer9</span><span class="o">.</span><span class="n">run_inference</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [noise_stddev, x0, c2, tau, lam, A]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
    <style>
        /* Turns off some styling */
        progress {
            /* gets rid of default border in Firefox and Opera. */
            border: none;
            /* Needs to be in here for Safari polyfill so background images work as expected. */
            background-size: auto;
        }
        .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
            background: #F44336;
        }
    </style>
  <progress value='24000' class='' max='24000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [24000/24000 1:33:43<00:00 Sampling 4 chains, 4,053 divergences]
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Sampling 4 chains for 2_000 tune and 4_000 draw iterations (8_000 + 16_000 draws total) took 5634 seconds.
The rhat statistic is larger than 1.01 for some parameters. This indicates problems during sampling. See https://arxiv.org/abs/1903.08008 for details
The effective sample size per chain is smaller than 100 for some parameters.  A higher number is needed for reliable rhat and ess computation. See https://arxiv.org/abs/1903.08008 for details
There were 4053 divergences after tuning. Increase `target_accept` or reparameterize.
Chain 0 reached the maximum tree depth. Increase `max_treedepth`, increase `target_accept` or reparameterize.
Chain 1 reached the maximum tree depth. Increase `max_treedepth`, increase `target_accept` or reparameterize.
Chain 2 reached the maximum tree depth. Increase `max_treedepth`, increase `target_accept` or reparameterize.
Chain 3 reached the maximum tree depth. Increase `max_treedepth`, increase `target_accept` or reparameterize.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
            mean   sd  hdi_3%  hdi_97%  mcse_mean  mcse_sd  ess_bulk  \
A[0, 0]    0.963  0.0   0.963    0.963        0.0      0.0     558.0
A[0, 1]   -0.005  0.0  -0.005   -0.005        0.0      0.0     884.0
A[0, 2]   -0.033  0.0  -0.033   -0.033        0.0      0.0     780.0
A[0, 3]   -0.008  0.0  -0.008   -0.008        0.0      0.0      20.0
A[0, 4]   -0.004  0.0  -0.004   -0.004        0.0      0.0     667.0
...          ...  ...     ...      ...        ...      ...       ...
A[11, 7]   0.020  0.0   0.020    0.020        0.0      0.0     121.0
A[11, 8]   0.027  0.0   0.027    0.027        0.0      0.0    1609.0
A[11, 9]  -0.101  0.0  -0.101   -0.101        0.0      0.0     943.0
A[11, 10]  0.020  0.0   0.020    0.020        0.0      0.0    1028.0
A[11, 11]  1.020  0.0   1.020    1.020        0.0      0.0    1107.0

           ess_tail  r_hat
A[0, 0]       168.0   1.03
A[0, 1]       504.0   1.03
A[0, 2]       380.0   1.05
A[0, 3]        16.0   1.15
A[0, 4]       242.0   1.03
...             ...    ...
A[11, 7]       26.0   1.04
A[11, 8]      803.0   1.03
A[11, 9]      479.0   1.01
A[11, 10]     434.0   1.02
A[11, 11]     548.0   1.04

[144 rows x 9 columns]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\ProgramData\anaconda3\envs\MIMIC\Lib\site-packages\arviz\plots\plot_utils.py:271: UserWarning: rcParams[&#39;plot.max_subplots&#39;] (40) is smaller than the number of variables to plot (144) in plot_posterior, generating only 40 plots
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Results saved as:
NetCDF file: model_posterior_large_v3.nc
Data file: data_large_v3.npz
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_MultiModel_Herold_examples-Herold-VAR_19_6.png" src="../../../_images/notebooks_MultiModel_Herold_examples-Herold-VAR_19_6.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">infer9</span><span class="o">.</span><span class="n">posterior_analysis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_MultiModel_Herold_examples-Herold-VAR_20_0.png" src="../../../_images/notebooks_MultiModel_Herold_examples-Herold-VAR_20_0.png" />
</div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">MIMIC</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html">Modelling and Inference of MICrobiomes Project (MIMIC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">mimic</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../examples.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../examples.html#jupyter-notebook-examples-by-model">Jupyter Notebook Examples by Model</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../examples.html#consumer-resource-model-crm">Consumer Resource Model (CRM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples.html#gaussian-processes-gp">Gaussian Processes (GP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples.html#multivariate-autoregressive-model-mvar">Multivariate Autoregressive Model (MVAR)</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../../examples.html#multi-model-analysis">Multi-Model Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples.html#vector-autoregression-var">Vector Autoregression (VAR)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples.html#generalized-lotka-volterra-glv">Generalized Lotka-Volterra (gLV)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../examples.html#generalized-metabolic-lotka-volterra-gmlv">Generalized Metabolic Lotka-Volterra (gMLV)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing to MIMIC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../history.html">History</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../examples.html">Examples</a><ul>
      <li>Previous: <a href="../../MVAR/examples-sim-MVAR.html" title="previous chapter">MVAR Simulation for Microbiota and Metabolites</a></li>
      <li>Next: <a href="examples-Herold-sVAR.html" title="next chapter">Sparse VAR on a Real Public Dataset, Herold et al. (2020)</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Pedro Fontanarrosa.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../../_sources/notebooks/MultiModel/Herold/examples-Herold-VAR.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>