<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MVAR Simulation for Microbiota and Metabolites &#8212; MIMIC 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=12dfc556" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="MVAR Simulation for Microbiota and Metabolites" href="examples-sim-MVAR.html" />
    <link rel="prev" title="Imputing Missing Values using Gaussian Process" href="../GP/examples-impute-GP.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="MVAR-Simulation-for-Microbiota-and-Metabolites">
<h1>MVAR Simulation for Microbiota and Metabolites<a class="headerlink" href="#MVAR-Simulation-for-Microbiota-and-Metabolites" title="Link to this heading">¶</a></h1>
<section id="MVAR-Process">
<h2>MVAR Process<a class="headerlink" href="#MVAR-Process" title="Link to this heading">¶</a></h2>
<p>The MVAR model extends the traditional VAR model used to fit abundances over time, by incorporating metabolites. The model can be expressed as follows:</p>
<div class="math notranslate nohighlight">
\[X_t = A \cdot X_{t-1} + \epsilon_{X,t}\]</div>
<div class="math notranslate nohighlight">
\[S_t = B \cdot X_{t-1} + \epsilon_{S,t}\]</div>
<p>where: - <span class="math notranslate nohighlight">\(X_t\)</span> is the vector of microbiota abundances at time <span class="math notranslate nohighlight">\(t\)</span>, - <span class="math notranslate nohighlight">\(S_t\)</span> is the vector of metabolite abundances at time <span class="math notranslate nohighlight">\(t\)</span>, - <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are matrices representing the interactions within microbiota and between microbiota and metabolites, respectively, - <span class="math notranslate nohighlight">\(\epsilon_{X,t}\)</span> and <span class="math notranslate nohighlight">\(\epsilon_{S,t}\)</span> are vectors of error terms, assumed to be normally distributed with mean 0 and a specific standard deviation.</p>
</section>
<section id="Objective">
<h2>Objective<a class="headerlink" href="#Objective" title="Link to this heading">¶</a></h2>
<p>The objective of this notebook is to simulate the dynamics between microbiota and metabolites using the MVAR model. Through simulation, we aim to demonstrate how specific interactions can be identified and quantified, providing insights into the causal relationships within these systems.</p>
</section>
<section id="Simulation-with-VARsim.py-for-sVAR-Models">
<h2>Simulation with <code class="docutils literal notranslate"><span class="pre">VARsim.py</span></code> for sVAR Models<a class="headerlink" href="#Simulation-with-VARsim.py-for-sVAR-Models" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">VARsim.py</span></code> script has been adapted to support MVAR simulation, allowing us to specify metabolite interaction matrices and simulate the dynamics of microbiota and metabolites over time. This section demonstrates how to use the script for simulating and visualizing the interactions captured by our MVAR model.</p>
</section>
<section id="Example-Usage-of-VARsim.py-for-MVAR-Simulation">
<h2>Example Usage of <code class="docutils literal notranslate"><span class="pre">VARsim.py</span></code> for MVAR Simulation<a class="headerlink" href="#Example-Usage-of-VARsim.py-for-MVAR-Simulation" title="Link to this heading">¶</a></h2>
<p>The implementation of the VAR model in <code class="docutils literal notranslate"><span class="pre">VARsim.py</span></code> allows for detailed simulation of the dynamic interactions between microbiota and their produced metabolites. The script is designed to facilitate straightforward simulation of these complex biological systems. The following code examples provide a guide on how to leverage the <code class="docutils literal notranslate"><span class="pre">VARsim.py</span></code> script to simulate these interactions effectively:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importing the libraries</span>
<span class="kn">from</span> <span class="nn">mimic.model_simulate.sim_VAR</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">mimic.model_infer.infer_VAR_bayes</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
</pre></div></div>
</div>
<p>First, let’s first generate synthetic data for microbiota using the sim_VAR class. We will then simulate the sparse interaction with a given matrix</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate a VAR model</span>

<span class="n">simulator</span> <span class="o">=</span> <span class="n">sim_VAR</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>We can now use the following parameters to generate the metabolic data:</p>
<p>```json { “coefficientsM”: [ [ 0.0, -0.5, 0.0 ], [ 0.1, 0.1, -0.1 ], [ -0.2, 0.1, 0.3 ] ], “initial_valuesM”: [ [ 2 ], [ 0 ], [ 0 ] ] }</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span><span class="o">.</span><span class="n">read_parameters</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;parametersS.json&#39;</span><span class="p">)</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">print_parameters</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model parameters:
Model: VAR
n_obs: 97
coefficients: [[ 0.8 -0.2  0.3]
 [ 0.3  0.5 -1. ]
 [ 0.2 -0.1  0.4]]
initial_values: [[1]
 [2]
 [0]]
noise_stddev: 1.2
output: show
coefficientsM: [[ 0.  -0.5  0. ]
 [ 0.1  0.1 -0.1]
 [-0.2  0.1  0.3]]
initial_valuesM: [[2]
 [0]
 [0]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="s1">&#39;MVARsim&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Using the following parameters for sVAR simulation: {&#39;n_obs&#39;: 97, &#39;coefficients&#39;: array([[ 0.8, -0.2,  0.3],
       [ 0.3,  0.5, -1. ],
       [ 0.2, -0.1,  0.4]]), &#39;initial_values&#39;: array([[1],
       [2],
       [0]]), &#39;noise_stddev&#39;: 1.2, &#39;output&#39;: &#39;show&#39;, &#39;coefficientsM&#39;: array([[ 0. , -0.5,  0. ],
       [ 0.1,  0.1, -0.1],
       [-0.2,  0.1,  0.3]]), &#39;initial_valuesM&#39;: array([[2],
       [0],
       [0]])}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_MVAR_examples-infer-MVAR_8_1.png" src="../../_images/notebooks_MVAR_examples-infer-MVAR_8_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 1.00000000e+00  2.00000000e+00  0.00000000e+00]
 [ 7.71851444e-01  9.47395412e-01  2.39128541e-01]
 [-8.58459939e-01  1.60173843e+00 -1.37650283e+00]
 [-2.38027867e+00  2.15155688e+00 -2.01468173e+00]
 [-3.73363331e+00  1.25779524e-01 -2.13408395e+00]
 [-3.24361296e+00  2.43518635e+00 -3.79960299e+00]
 [-4.89353691e+00  4.23686712e+00 -2.16491850e+00]
 [-6.02276404e+00  3.97118937e+00 -8.52549445e-01]
 [-6.04156101e+00 -1.44421507e-02 -1.32821916e+00]
 [-5.10570396e+00 -1.95483632e+00 -2.85303524e+00]
 [-3.65107117e+00 -9.65147868e-01 -1.21224721e+00]
 [-3.05628983e+00 -4.77603982e-01 -1.77874510e+00]
 [-4.48344841e-01  1.86108969e-01  6.78969655e-02]
 [ 1.89522755e-01 -3.40287970e-01 -1.68903684e+00]
 [-3.59502417e-02  1.55581080e+00 -1.87260987e+00]
 [-1.00308421e+00  2.10227893e+00 -1.71301567e+00]
 [ 1.75359084e-01  2.96975468e+00 -1.48665452e+00]
 [-1.07512520e+00  3.11632197e+00 -2.22603245e+00]
 [-4.98749317e+00  1.56224475e+00 -2.62756719e+00]
 [-4.96086036e+00  2.61574094e+00 -2.51322437e+00]
 [-5.03802548e+00  3.48226264e+00 -5.87292328e-01]
 [-6.81177178e+00  1.07447236e+00 -8.80118880e-01]
 [-7.24628154e+00 -2.92200239e+00 -2.11725245e+00]
 [-6.55568010e+00 -1.85900523e+00 -1.63770199e+00]
 [-3.21408187e+00 -1.25158284e+00 -2.61245594e+00]
 [-4.75177006e+00  1.04973470e+00 -9.49844780e-01]
 [-6.28073100e+00 -7.61124823e-01 -1.64404885e+00]
 [-4.57456858e+00 -1.49356036e+00 -3.10841397e+00]
 [-2.77788952e+00 -4.86292342e-01  2.71131461e-02]
 [ 3.06104984e-01 -1.36978294e+00 -1.80284079e-01]
 [-9.94993246e-01 -7.69599508e-01  2.53672076e+00]
 [ 1.00936211e-01 -3.24776599e+00  2.41706029e-01]
 [ 2.79065076e-01 -2.70418848e+00  3.88011157e-01]
 [ 1.20591902e+00  4.89961004e-03  8.18764275e-01]
 [ 3.64113410e-02 -9.42923649e-01  3.23319747e+00]
 [ 2.09879257e+00 -2.77038543e+00  5.89958017e-01]
 [ 1.19016552e+00  3.93000944e-01 -1.30570994e-01]
 [ 2.52930310e+00  1.09040762e+00 -8.03064383e-02]
 [ 6.79060141e-01  4.54379559e-01  1.86374899e+00]
 [ 7.75343646e-01 -2.27493187e+00 -1.02208501e+00]
 [ 1.96521592e-01 -1.62416331e+00 -1.84297377e-01]
 [ 1.31745862e+00 -5.85369095e-01 -2.57584985e+00]
 [-1.10215862e+00  4.92739098e+00 -4.24350479e-01]
 [-4.39609544e+00  2.77050356e+00  1.37138795e+00]
 [-3.40891890e+00 -3.17280655e+00 -2.80142682e+00]
 [-3.23789814e+00  1.81885145e+00 -1.42649054e+00]
 [-1.83494952e+00  1.62592626e+00 -3.55137823e+00]
 [-3.05196170e+00  3.72818646e+00 -2.82321708e+00]
 [-4.46142464e+00  3.19287875e+00 -3.76189334e+00]
 [-4.14257298e+00  5.59836492e+00 -2.60625005e+00]
 [-5.74325908e+00  3.49820799e+00 -2.53561345e+00]
 [-7.67994598e+00  2.28752992e+00 -3.81536463e+00]
 [-5.62676896e+00  1.04915099e+00 -4.01618188e+00]
 [-5.80231131e+00  1.70199481e+00 -4.02449710e+00]
 [-8.32078158e+00  2.07921711e+00 -2.18013346e+00]
 [-6.64551419e+00 -1.26103209e+00 -4.03274798e+00]
 [-7.62604956e+00  1.87495845e+00 -2.24451565e+00]
 [-6.24767369e+00  1.53006967e+00 -1.03615837e+00]
 [-5.02385981e+00 -7.22494067e-01 -5.46597830e-01]
 [-3.57763982e+00 -8.24189975e-01 -3.14351962e+00]
 [-2.93369757e+00  1.74278373e+00 -1.34592473e+00]
 [-2.37392994e+00  1.45088822e+00 -1.76254587e+00]
 [-2.78412872e+00  3.68173130e+00 -2.14210223e+00]
 [-3.45235946e+00  4.20799529e+00 -7.55035094e-01]
 [-3.02523721e+00  2.08324611e-01 -9.17391207e-01]
 [-3.99632651e+00 -1.05000591e+00  4.89841422e-02]
 [-1.57420744e+00 -2.76107426e+00  8.88620517e-02]
 [-2.89211761e+00 -1.82741271e+00 -1.02073745e+00]
 [-3.15125092e+00 -1.45400988e+00 -7.80500191e-01]
 [-4.09982548e+00 -7.01694749e-01  4.03279626e-01]
 [-2.62115129e+00 -1.88234186e+00 -1.12538644e+00]
 [-3.02711806e+00 -5.13375589e-01  3.34200938e-03]
 [-8.33752023e-01 -1.16442626e+00  2.98112211e-01]
 [-2.89303359e-01 -6.79377039e-01  2.76390530e+00]
 [ 8.63406189e-01 -1.51811057e+00  1.30096898e+00]
 [ 2.70582979e+00 -1.99569289e+00  1.92588911e+00]
 [ 3.16154429e+00 -3.78253317e+00  4.07192353e+00]
 [ 3.25974912e+00 -6.19314576e+00  4.38270416e+00]
 [ 4.74862664e+00 -4.07817740e+00  2.17392975e+00]
 [ 5.04587514e+00 -8.70150483e-01  8.02987304e-01]
 [ 1.89987638e+00 -8.97857866e-02  1.77020420e+00]
 [ 3.10391611e+00 -1.52645897e+00  9.45876119e-02]
 [ 1.61286983e+00  2.31021887e-01  2.98816265e+00]
 [ 2.02273397e+00 -4.02171155e+00  1.23665544e+00]
 [ 3.21011340e+00 -4.02635652e+00 -8.52366129e-01]
 [ 2.70495998e+00  7.22677234e-01 -1.07539302e+00]
 [ 4.06432212e+00  1.78195157e+00  2.03579250e+00]
 [ 2.34591546e+00 -4.69910987e-03  8.01355261e-01]
 [-6.78200779e-01  4.79880232e-01  1.57863887e+00]
 [ 1.07370606e+00 -2.30401588e+00  4.52757275e-01]
 [ 1.69491868e+00 -1.15555373e+00  2.51236188e-02]
 [ 1.02136497e+00  1.43845024e+00  1.07080261e+00]
 [ 2.24142962e+00  6.58663426e-01 -5.04647619e-02]
 [ 2.56437515e+00 -5.17073689e-01 -1.31288554e+00]
 [ 1.72433020e+00  3.20250910e+00 -2.07287806e+00]
 [-1.09526331e-01  5.17278127e+00 -1.36495565e+00]
 [-1.17578799e+00  3.59095875e+00  1.08995450e+00]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataM</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">dataM</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 2.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 1.20675937e+00 -1.03692268e+00  1.08452564e+00]
 [ 2.42167521e-01 -9.72424051e-02 -9.75854292e-01]
 [ 1.07510178e+00 -1.80632240e-01  5.20866821e-01]
 [-2.10808435e-01  3.67010841e-01 -1.72639969e+00]
 [ 6.85458757e-01 -6.88743165e-01 -7.42434366e-01]
 [-2.14557373e+00 -4.77048819e-01 -2.22589038e+00]
 [-1.06082311e+00 -1.28581356e+00  1.22381378e+00]
 [-1.20030839e+00 -7.95079492e-01  1.36592175e+00]
 [-5.79507897e-01 -2.84620279e-02  1.83198345e+00]
 [ 1.81008074e+00 -2.90510914e+00 -1.31624632e+00]
 [ 1.90583477e+00 -1.02733025e+00 -1.63813580e-01]
 [-3.15190397e-01 -6.92433918e-01 -1.03682518e+00]
 [ 1.16981702e+00  2.73042150e+00 -9.69837282e-01]
 [ 6.06474727e-01  1.98461503e+00 -7.77179653e-01]
 [-2.47442741e+00  2.35563540e+00  1.16819826e+00]
 [-1.52165865e+00 -3.11277596e-01  6.05416500e-01]
 [-3.39448333e+00  9.11823505e-01 -3.75088040e-01]
 [-2.52547202e+00 -1.33106736e+00  5.28181266e-01]
 [-8.20344570e-01 -6.52130274e-01 -2.04803514e-01]
 [-1.26230244e+00 -2.05770139e-01  2.20663563e+00]
 [-1.63238067e+00 -2.35229930e-01  1.40744970e+00]
 [-1.67561788e-01  2.37625675e+00  3.59118098e+00]
 [ 3.11174298e+00 -6.34158606e-01  6.23781423e-01]
 [ 2.09786152e-01 -7.74903526e-01 -8.78362511e-01]
 [ 9.59502885e-01  1.02043803e+00  2.11978079e-01]
 [-9.58405207e-02 -2.94106599e-01  5.29916635e-01]
 [ 1.00796531e+00 -1.92787467e+00  2.36748861e-01]
 [ 6.98471997e-02 -1.00140862e+00 -1.04230219e+00]
 [ 9.50779577e-02 -1.72330695e-01 -1.55225146e-01]
 [ 1.62689957e-02 -1.19304066e+00 -1.77112649e+00]
 [ 7.04184158e-01  2.01279475e+00 -1.26189248e+00]
 [ 1.78189787e+00  1.64443665e+00 -1.75845921e+00]
 [ 2.35536323e+00 -6.15319583e-01 -2.30387728e+00]
 [ 2.75398478e-02 -2.70566784e-01 -5.13305237e-02]
 [ 1.01395400e+00 -2.10124254e+00  2.11346227e+00]
 [ 1.67435807e+00 -7.49782940e-01 -4.26153855e-01]
 [-9.00380466e-02  2.44510241e+00  7.58747334e-01]
 [ 1.18559112e+00  1.85596515e-01  6.73483007e-01]
 [ 1.82625874e+00  6.92392710e-01 -6.89323893e-01]
 [ 5.40978013e-01  4.61093701e-02 -1.22954574e+00]
 [ 2.92686338e-02  1.25784725e+00  1.75158070e-01]
 [ 1.62773542e+00  6.85378061e-01  1.65744602e+00]
 [-3.18494558e+00  1.46695015e+00 -1.70362799e+00]
 [-2.33543120e+00 -1.27157329e+00  2.76700129e+00]
 [ 1.42319893e-01 -9.57169702e-01 -2.19342616e+00]
 [ 1.93375122e-01  3.11310548e-01 -2.19887641e+00]
 [ 4.06375839e-03 -7.49459592e-01  4.73781086e-01]
 [-1.89562520e-01  7.86797736e-01  3.09489133e-01]
 [-2.59760753e+00 -1.58515732e-01 -1.19180028e+00]
 [-5.24981305e+00  1.12076059e+00  2.69786543e-01]
 [-2.31228127e+00  3.97694204e-01 -1.09812364e+00]
 [-2.21055972e+00  2.87868045e-01  1.37618714e+00]
 [-9.83604227e-01  5.89693084e-01 -1.11676694e+00]
 [-2.07877592e+00  1.87567714e+00  8.97599845e-02]
 [ 2.00853380e-01  6.86283162e-02  3.05266944e+00]
 [ 4.87106711e-02  1.18565660e+00  3.01406009e-01]
 [ 6.59665489e-01 -4.93216417e-01  5.74265372e-01]
 [-7.64383274e-01 -8.30444918e-01  3.01227751e+00]
 [ 1.56702782e+00 -1.22398350e+00  1.41422710e+00]
 [-4.06838360e-01  2.79201789e-02 -1.67379897e+00]
 [ 6.56497157e-01 -2.38086300e-01  2.61780524e+00]
 [-2.33061329e-01  1.39386691e+00  2.38864738e+00]
 [-3.46251211e+00  1.61853212e+00  1.04380257e-01]
 [-3.35208308e+00 -1.22890313e+00 -1.45824550e+00]
 [ 7.72233419e-01  1.63136122e-01  1.55927912e+00]
 [-1.34400464e-01 -2.81555389e+00  4.25577060e+00]
 [ 2.57225745e+00 -1.40856104e+00  4.41805203e-01]
 [ 1.57767106e+00  2.42784047e-02  1.51942802e+00]
 [ 3.11957685e-01  5.28688436e-01 -4.41360829e-01]
 [ 2.19363963e+00  6.05037069e-03  2.39419211e+00]
 [ 7.35765323e-01  4.90137928e-01  3.36974315e-01]
 [ 2.56307089e+00  1.20641413e+00 -8.72038091e-01]
 [ 1.34730201e+00 -1.00528202e+00  4.54441255e-01]
 [ 1.39941878e+00  9.50436785e-01  1.60437818e+00]
 [ 1.72351014e+00  1.63296408e+00  8.72916051e-01]
 [-1.15621977e-01  6.53078708e-01 -1.44087914e-01]
 [ 4.07364682e+00  7.37283947e-01 -2.33567544e+00]
 [ 1.98619960e+00 -1.52408630e+00  1.40864846e-01]
 [ 4.04032336e+00 -6.71011216e-01  2.66304086e-01]
 [ 1.34144487e+00  1.75566182e+00  1.27277493e+00]
 [ 3.73889731e+00  1.42247604e+00 -1.12724579e+00]
 [ 2.31636627e+00  1.20934899e+00  6.06888208e-01]
 [-1.98054578e-01  3.11968224e-02  3.18802053e+00]
 [ 2.99156897e+00 -2.62845816e+00 -1.55704171e-01]
 [ 3.39931594e+00 -5.07385650e-02 -1.44289466e+00]
 [-7.90641992e-02  7.38097673e-01 -1.58523824e-01]
 [-2.72398474e+00  2.05344175e+00 -9.32270663e-02]
 [ 3.54386573e-01 -2.32665969e+00 -4.49629985e-01]
 [-1.58554732e+00 -5.38500217e-01 -8.99448032e-01]
 [ 1.19706551e+00 -6.60973406e-01 -9.39147240e-01]
 [ 1.75599036e+00 -2.51126539e-01 -1.70891989e+00]
 [-2.12065578e+00 -9.41110001e-02  9.03499860e-01]
 [ 1.58792293e+00 -5.39784499e-01  3.53161089e-01]
 [ 3.54235216e-01 -4.46873116e-01  9.35582305e-01]
 [-9.73946380e-01  3.33758838e-01 -3.01487439e-01]
 [-2.56908405e+00  8.13759901e-01 -2.56299150e-01]]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">infer</span> <span class="o">=</span> <span class="n">infer_VAR</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">dataS</span><span class="o">=</span><span class="n">dataM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">infer</span><span class="o">.</span><span class="n">run_inference_xs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (2 chains in 2 jobs)
NUTS: [X0h, S0h, Ah, Bh, sigma]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
    <style>
        /* Turns off some styling */
        progress {
            /* gets rid of default border in Firefox and Opera. */
            border: none;
            /* Needs to be in here for Safari polyfill so background images work as expected. */
            background-size: auto;
        }
        .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
            background: #F44336;
        }
    </style>
  <progress value='6000' class='' max='6000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [6000/6000 00:24<00:00 Sampling 2 chains, 0 divergences]
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Sampling 2 chains for 1_000 tune and 2_000 draw iterations (2_000 + 4_000 draws total) took 29 seconds.
We recommend running at least 4 chains for robust computation of convergence diagnostics
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
           mean     sd  hdi_3%  hdi_97%  mcse_mean  mcse_sd  ess_bulk  \
Ah[0, 0]  0.721  0.046   0.632    0.806      0.001    0.001    3113.0
Ah[0, 1] -0.223  0.056  -0.323   -0.113      0.001    0.001    3503.0
Ah[0, 2]  0.385  0.090   0.225    0.561      0.002    0.001    3522.0
Ah[1, 0]  0.397  0.039   0.327    0.473      0.001    0.000    3644.0
Ah[1, 1]  0.439  0.050   0.342    0.529      0.001    0.001    4183.0
Ah[1, 2] -1.096  0.075  -1.233   -0.958      0.001    0.001    3393.0
Ah[2, 0]  0.209  0.049   0.121    0.307      0.001    0.001    2927.0
Ah[2, 1] -0.071  0.057  -0.176    0.045      0.001    0.001    1529.0
Ah[2, 2]  0.404  0.091   0.235    0.579      0.002    0.001    2130.0
Bh[0, 0]  0.183  0.272  -0.361    0.667      0.007    0.005    1690.0
Bh[0, 1] -0.678  0.141  -0.958   -0.431      0.003    0.002    2147.0
Bh[0, 2] -0.463  0.679  -1.785    0.802      0.017    0.012    1695.0
Bh[1, 0]  0.349  0.273  -0.181    0.899      0.008    0.006    1556.0
Bh[1, 1]  0.005  0.140  -0.256    0.270      0.003    0.003    1662.0
Bh[1, 2] -0.745  0.681  -2.162    0.525      0.020    0.014    1616.0
Bh[2, 0] -0.208  0.258  -0.691    0.319      0.005    0.004    2426.0
Bh[2, 1]  0.093  0.132  -0.147    0.351      0.003    0.002    2687.0
Bh[2, 2]  0.344  0.641  -0.994    1.536      0.013    0.010    2353.0

          ess_tail  r_hat
Ah[0, 0]    2910.0    1.0
Ah[0, 1]    2461.0    1.0
Ah[0, 2]    2694.0    1.0
Ah[1, 0]    3039.0    1.0
Ah[1, 1]    2788.0    1.0
Ah[1, 2]    2870.0    1.0
Ah[2, 0]    2745.0    1.0
Ah[2, 1]    1273.0    1.0
Ah[2, 2]    1958.0    1.0
Bh[0, 0]    1746.0    1.0
Bh[0, 1]    2242.0    1.0
Bh[0, 2]    1552.0    1.0
Bh[1, 0]     706.0    1.0
Bh[1, 1]    1337.0    1.0
Bh[1, 2]     621.0    1.0
Bh[2, 0]    2010.0    1.0
Bh[2, 1]    2265.0    1.0
Bh[2, 2]    1808.0    1.0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">infer</span><span class="o">.</span><span class="n">posterior_analysis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
           mean     sd  hdi_3%  hdi_97%  mcse_mean  mcse_sd  ess_bulk  \
Ah[0, 0]  0.721  0.046   0.632    0.806      0.001    0.001    3113.0
Ah[0, 1] -0.223  0.056  -0.323   -0.113      0.001    0.001    3503.0
Ah[0, 2]  0.385  0.090   0.225    0.561      0.002    0.001    3522.0
Ah[1, 0]  0.397  0.039   0.327    0.473      0.001    0.000    3644.0
Ah[1, 1]  0.439  0.050   0.342    0.529      0.001    0.001    4183.0
Ah[1, 2] -1.096  0.075  -1.233   -0.958      0.001    0.001    3393.0
Ah[2, 0]  0.209  0.049   0.121    0.307      0.001    0.001    2927.0
Ah[2, 1] -0.071  0.057  -0.176    0.045      0.001    0.001    1529.0
Ah[2, 2]  0.404  0.091   0.235    0.579      0.002    0.001    2130.0
Bh[0, 0]  0.183  0.272  -0.361    0.667      0.007    0.005    1690.0
Bh[0, 1] -0.678  0.141  -0.958   -0.431      0.003    0.002    2147.0
Bh[0, 2] -0.463  0.679  -1.785    0.802      0.017    0.012    1695.0
Bh[1, 0]  0.349  0.273  -0.181    0.899      0.008    0.006    1556.0
Bh[1, 1]  0.005  0.140  -0.256    0.270      0.003    0.003    1662.0
Bh[1, 2] -0.745  0.681  -2.162    0.525      0.020    0.014    1616.0
Bh[2, 0] -0.208  0.258  -0.691    0.319      0.005    0.004    2426.0
Bh[2, 1]  0.093  0.132  -0.147    0.351      0.003    0.002    2687.0
Bh[2, 2]  0.344  0.641  -0.994    1.536      0.013    0.010    2353.0

          ess_tail  r_hat
Ah[0, 0]    2910.0    1.0
Ah[0, 1]    2461.0    1.0
Ah[0, 2]    2694.0    1.0
Ah[1, 0]    3039.0    1.0
Ah[1, 1]    2788.0    1.0
Ah[1, 2]    2870.0    1.0
Ah[2, 0]    2745.0    1.0
Ah[2, 1]    1273.0    1.0
Ah[2, 2]    1958.0    1.0
Bh[0, 0]    1746.0    1.0
Bh[0, 1]    2242.0    1.0
Bh[0, 2]    1552.0    1.0
Bh[1, 0]     706.0    1.0
Bh[1, 1]    1337.0    1.0
Bh[1, 2]     621.0    1.0
Bh[2, 0]    2010.0    1.0
Bh[2, 1]    2265.0    1.0
Bh[2, 2]    1808.0    1.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_MVAR_examples-infer-MVAR_13_1.png" src="../../_images/notebooks_MVAR_examples-infer-MVAR_13_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_MVAR_examples-infer-MVAR_13_2.png" src="../../_images/notebooks_MVAR_examples-infer-MVAR_13_2.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we can also plot the results with the original paremetr values that we used to simulate the data</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span>  <span class="mf">0.3</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>  <span class="mf">0.4</span><span class="p">]])</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">infer</span><span class="o">.</span><span class="n">posterior_analysis</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
           mean     sd  hdi_3%  hdi_97%  mcse_mean  mcse_sd  ess_bulk  \
Ah[0, 0]  0.721  0.046   0.632    0.806      0.001    0.001    3113.0
Ah[0, 1] -0.223  0.056  -0.323   -0.113      0.001    0.001    3503.0
Ah[0, 2]  0.385  0.090   0.225    0.561      0.002    0.001    3522.0
Ah[1, 0]  0.397  0.039   0.327    0.473      0.001    0.000    3644.0
Ah[1, 1]  0.439  0.050   0.342    0.529      0.001    0.001    4183.0
Ah[1, 2] -1.096  0.075  -1.233   -0.958      0.001    0.001    3393.0
Ah[2, 0]  0.209  0.049   0.121    0.307      0.001    0.001    2927.0
Ah[2, 1] -0.071  0.057  -0.176    0.045      0.001    0.001    1529.0
Ah[2, 2]  0.404  0.091   0.235    0.579      0.002    0.001    2130.0
Bh[0, 0]  0.183  0.272  -0.361    0.667      0.007    0.005    1690.0
Bh[0, 1] -0.678  0.141  -0.958   -0.431      0.003    0.002    2147.0
Bh[0, 2] -0.463  0.679  -1.785    0.802      0.017    0.012    1695.0
Bh[1, 0]  0.349  0.273  -0.181    0.899      0.008    0.006    1556.0
Bh[1, 1]  0.005  0.140  -0.256    0.270      0.003    0.003    1662.0
Bh[1, 2] -0.745  0.681  -2.162    0.525      0.020    0.014    1616.0
Bh[2, 0] -0.208  0.258  -0.691    0.319      0.005    0.004    2426.0
Bh[2, 1]  0.093  0.132  -0.147    0.351      0.003    0.002    2687.0
Bh[2, 2]  0.344  0.641  -0.994    1.536      0.013    0.010    2353.0

          ess_tail  r_hat
Ah[0, 0]    2910.0    1.0
Ah[0, 1]    2461.0    1.0
Ah[0, 2]    2694.0    1.0
Ah[1, 0]    3039.0    1.0
Ah[1, 1]    2788.0    1.0
Ah[1, 2]    2870.0    1.0
Ah[2, 0]    2745.0    1.0
Ah[2, 1]    1273.0    1.0
Ah[2, 2]    1958.0    1.0
Bh[0, 0]    1746.0    1.0
Bh[0, 1]    2242.0    1.0
Bh[0, 2]    1552.0    1.0
Bh[1, 0]     706.0    1.0
Bh[1, 1]    1337.0    1.0
Bh[1, 2]     621.0    1.0
Bh[2, 0]    2010.0    1.0
Bh[2, 1]    2265.0    1.0
Bh[2, 2]    1808.0    1.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_MVAR_examples-infer-MVAR_15_1.png" src="../../_images/notebooks_MVAR_examples-infer-MVAR_15_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_MVAR_examples-infer-MVAR_15_2.png" src="../../_images/notebooks_MVAR_examples-infer-MVAR_15_2.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">infer2</span> <span class="o">=</span> <span class="n">infer_VAR</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">dataS</span><span class="o">=</span><span class="n">dataM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">infer2</span><span class="o">.</span><span class="n">run_inference_large_xs</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [c2_A, tau_A, lam_A, Ah, c2_B, tau_B, lam_B, Bh, sigma]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
    <style>
        /* Turns off some styling */
        progress {
            /* gets rid of default border in Firefox and Opera. */
            border: none;
            /* Needs to be in here for Safari polyfill so background images work as expected. */
            background-size: auto;
        }
        .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
            background: #F44336;
        }
    </style>
  <progress value='24000' class='' max='24000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [24000/24000 02:17<00:00 Sampling 4 chains, 4,119 divergences]
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Sampling 4 chains for 2_000 tune and 4_000 draw iterations (8_000 + 16_000 draws total) took 146 seconds.
The rhat statistic is larger than 1.01 for some parameters. This indicates problems during sampling. See https://arxiv.org/abs/1903.08008 for details
The effective sample size per chain is smaller than 100 for some parameters.  A higher number is needed for reliable rhat and ess computation. See https://arxiv.org/abs/1903.08008 for details
There were 4119 divergences after tuning. Increase `target_accept` or reparameterize.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
           mean     sd  hdi_3%  hdi_97%  mcse_mean  mcse_sd  ess_bulk  \
Ah[0, 0]  0.729  0.034   0.664    0.792      0.002    0.001     406.0
Ah[0, 1] -0.220  0.045  -0.303   -0.137      0.001    0.001    1290.0
Ah[0, 2]  0.382  0.065   0.259    0.506      0.002    0.002     716.0
Ah[1, 0]  0.397  0.028   0.343    0.451      0.001    0.000    2454.0
Ah[1, 1]  0.458  0.035   0.391    0.521      0.002    0.002     273.0
Ah[1, 2] -1.076  0.061  -1.186   -0.974      0.009    0.006      54.0
Ah[2, 0]  0.208  0.036   0.144    0.281      0.001    0.001    2263.0
Ah[2, 1] -0.062  0.045  -0.154    0.014      0.001    0.001    1342.0
Ah[2, 2]  0.402  0.070   0.271    0.528      0.007    0.005      94.0
Bh[0, 0]  0.006  0.036  -0.053    0.065      0.001    0.001    1195.0
Bh[0, 1] -0.602  0.057  -0.717   -0.504      0.002    0.002     582.0
Bh[0, 2] -0.008  0.088  -0.154    0.118      0.005    0.003      67.0
Bh[1, 0]  0.054  0.093  -0.032    0.257      0.005    0.004     242.0
Bh[1, 1]  0.041  0.048  -0.025    0.144      0.001    0.001    1603.0
Bh[1, 2] -0.076  0.208  -0.565    0.139      0.011    0.008     702.0
Bh[2, 0] -0.045  0.046  -0.129    0.023      0.001    0.001    1984.0
Bh[2, 1]  0.022  0.039  -0.040    0.105      0.003    0.002     171.0
Bh[2, 2] -0.028  0.095  -0.253    0.085      0.003    0.002    1157.0

          ess_tail  r_hat
Ah[0, 0]    5415.0   1.01
Ah[0, 1]     621.0   1.08
Ah[0, 2]     737.0   1.01
Ah[1, 0]    6495.0   1.06
Ah[1, 1]    4915.0   1.02
Ah[1, 2]     244.0   1.05
Ah[2, 0]    3112.0   1.03
Ah[2, 1]     850.0   1.01
Ah[2, 2]    3948.0   1.03
Bh[0, 0]     964.0   1.01
Bh[0, 1]    3393.0   1.01
Bh[0, 2]     937.0   1.04
Bh[1, 0]     738.0   1.02
Bh[1, 1]    1797.0   1.01
Bh[1, 2]     703.0   1.04
Bh[2, 0]    2884.0   1.04
Bh[2, 1]    1137.0   1.02
Bh[2, 2]     325.0   1.03
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">infer2</span><span class="o">.</span><span class="n">posterior_analysis</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
           mean     sd  hdi_3%  hdi_97%  mcse_mean  mcse_sd  ess_bulk  \
Ah[0, 0]  0.729  0.034   0.664    0.792      0.002    0.001     406.0
Ah[0, 1] -0.220  0.045  -0.303   -0.137      0.001    0.001    1290.0
Ah[0, 2]  0.382  0.065   0.259    0.506      0.002    0.002     716.0
Ah[1, 0]  0.397  0.028   0.343    0.451      0.001    0.000    2454.0
Ah[1, 1]  0.458  0.035   0.391    0.521      0.002    0.002     273.0
Ah[1, 2] -1.076  0.061  -1.186   -0.974      0.009    0.006      54.0
Ah[2, 0]  0.208  0.036   0.144    0.281      0.001    0.001    2263.0
Ah[2, 1] -0.062  0.045  -0.154    0.014      0.001    0.001    1342.0
Ah[2, 2]  0.402  0.070   0.271    0.528      0.007    0.005      94.0
Bh[0, 0]  0.006  0.036  -0.053    0.065      0.001    0.001    1195.0
Bh[0, 1] -0.602  0.057  -0.717   -0.504      0.002    0.002     582.0
Bh[0, 2] -0.008  0.088  -0.154    0.118      0.005    0.003      67.0
Bh[1, 0]  0.054  0.093  -0.032    0.257      0.005    0.004     242.0
Bh[1, 1]  0.041  0.048  -0.025    0.144      0.001    0.001    1603.0
Bh[1, 2] -0.076  0.208  -0.565    0.139      0.011    0.008     702.0
Bh[2, 0] -0.045  0.046  -0.129    0.023      0.001    0.001    1984.0
Bh[2, 1]  0.022  0.039  -0.040    0.105      0.003    0.002     171.0
Bh[2, 2] -0.028  0.095  -0.253    0.085      0.003    0.002    1157.0

          ess_tail  r_hat
Ah[0, 0]    5415.0   1.01
Ah[0, 1]     621.0   1.08
Ah[0, 2]     737.0   1.01
Ah[1, 0]    6495.0   1.06
Ah[1, 1]    4915.0   1.02
Ah[1, 2]     244.0   1.05
Ah[2, 0]    3112.0   1.03
Ah[2, 1]     850.0   1.01
Ah[2, 2]    3948.0   1.03
Bh[0, 0]     964.0   1.01
Bh[0, 1]    3393.0   1.01
Bh[0, 2]     937.0   1.04
Bh[1, 0]     738.0   1.02
Bh[1, 1]    1797.0   1.01
Bh[1, 2]     703.0   1.04
Bh[2, 0]    2884.0   1.04
Bh[2, 1]    1137.0   1.02
Bh[2, 2]     325.0   1.03
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_MVAR_examples-infer-MVAR_18_1.png" src="../../_images/notebooks_MVAR_examples-infer-MVAR_18_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_MVAR_examples-infer-MVAR_18_2.png" src="../../_images/notebooks_MVAR_examples-infer-MVAR_18_2.png" />
</div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">MIMIC</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../readme.html">Modelling and Inference of MICrobiomes Project (MIMIC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">mimic</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../MultiModel/Herold/examples-Herold-VAR.html">VAR inference on a Real Public Dataset, Herold et al. (2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MultiModel/Herold/examples-Herold-VAR.html#Separate-the-data-into-MG-and-MT-datasets">Separate the data into MG and MT datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MultiModel/Herold/examples_impute_data.html">Data imputation on a Real Public Dataset, Herold et al. (2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MultiModel/Herold/examples-Herold-sVAR.html">Sparse VAR on a Real Public Dataset, Herold et al. (2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MultiModel/Herold/examples-Herold-sVAR.html#Separate-the-data-into-MG-and-MT-datasets">Separate the data into MG and MT datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../VAR/examples-bayes-VAR.html">Bayesian Inference for Vector AutoRegression (VAR) Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../VAR/examples-sim-VAR.html">Vector AutoRegression (VAR) Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gLV/examples-sim-gLV.html">Simulate some time course data from the gLV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gLV/examples-bayes-gLV.html">Used Bayesian inference to infer the parameters of a (linearised) gLV model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gLV/examples-Stein.html">Repeat Stein et al. 2013 analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gLV/examples-lasso-gLV.html">Comparison of ridge vs lasso regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gLV/examples-ridge-gLV.html">Simulate some time course data and perform ridge regression as in Stein et al. 2013</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gMLV/examples-sim-gMLV.html">Simulate some time course data from the gMLV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gMLV/examples-ridge-lasso-gMLV.html">Run ridge regression and lasso for the gMLV model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../GP/examples-impute-GP_Stein.html">Using the Data Imputator on a Real Public Dataset - Stein et al. (2013)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../GP/examples-impute-GP.html">Imputing Missing Values using Gaussian Process</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">MVAR Simulation for Microbiota and Metabolites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#MVAR-Process">MVAR Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Objective">Objective</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simulation-with-VARsim.py-for-sVAR-Models">Simulation with <code class="docutils literal notranslate"><span class="pre">VARsim.py</span></code> for sVAR Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-Usage-of-VARsim.py-for-MVAR-Simulation">Example Usage of <code class="docutils literal notranslate"><span class="pre">VARsim.py</span></code> for MVAR Simulation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples-sim-MVAR.html">MVAR Simulation for Microbiota and Metabolites</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to MIMIC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../history.html">History</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../../examples.html">Examples</a><ul>
      <li>Previous: <a href="../GP/examples-impute-GP.html" title="previous chapter">Imputing Missing Values using Gaussian Process</a></li>
      <li>Next: <a href="examples-sim-MVAR.html" title="next chapter">MVAR Simulation for Microbiota and Metabolites</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Pedro Fontanarrosa.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../_sources/notebooks/MVAR/examples-infer-MVAR.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>