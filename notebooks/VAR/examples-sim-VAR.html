<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Vector AutoRegression (VAR) Simulation &#8212; MIMIC 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=12dfc556" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />
    <script src="../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Bayesian Inference for Vector AutoRegression (VAR) Models" href="examples-bayes-VAR.html" />
    <link rel="prev" title="MVAR Simulation for Microbiota and Metabolites" href="../MVAR/examples-sim-MVAR.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Vector-AutoRegression-(VAR)-Simulation">
<h1>Vector AutoRegression (VAR) Simulation<a class="headerlink" href="#Vector-AutoRegression-(VAR)-Simulation" title="Link to this heading">¶</a></h1>
<section id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Link to this heading">¶</a></h2>
<p><em>Vector AutoRegression</em> (VAR) is a statistical model that captures the linear interdependencies among multiple time series. VAR models treat all variables in the system as endogenous, allowing for the analysis and forecasting of systems where variables mutually influence each other.</p>
<p>This approach is particularly useful for analyzing and forecasting systems where variables influence each other. In economics and finance, VAR models are commonly applied to study the dynamic impact of shocks in one variable on the entire system of variables. MIMIC, however, uses VAR models to simulate the dynamics of a microbiome system, where the abundances of different microbial species influence each other over time.</p>
<section id="VAR(1)-Process">
<h3>VAR(1) Process<a class="headerlink" href="#VAR(1)-Process" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">VARsim.py</span></code> script simulates data from a VAR(1) process, which is the simplest form of VAR model where each variable’s current value is influenced by the immediately preceding values of all variables in the system. The general formula for a VAR(1) process with $ n $ variables is:</p>
<div class="math notranslate nohighlight">
\[X_t = A \cdot X_{t-1} + \epsilon_t\]</div>
<p>where: - $ X_t $ is the vector of variables at time $ t $, - $ A $ is the matrix of coefficients, capturing the influence of each variable’s previous value on the current value of all variables in the system, - $ <span class="math">\epsilon</span>_t $ is the vector of error terms, assumed to be normally distributed with mean 0 and a specific standard deviation.</p>
<p>In the script, <code class="docutils literal notranslate"><span class="pre">generate_var1_data</span></code> method is used to simulate data based on the VAR(1) model parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n_obs</span></code>: Number of observations to generate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coefficients</span></code>: Coefficient matrix for the VAR(1) process. It should be a square matrix of shape $ (n, n) $.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">initial_values</span></code>: Initial values for the process, a vector of shape $ (n,) $.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">noise_stddev</span></code>: Standard deviation of the noise term.</p></li>
</ul>
<p>This method generates a time series data set following the specified VAR(1) process, allowing for the exploration of dynamic relationships among variables.</p>
</section>
<section id="Visualization-Methods">
<h3>Visualization Methods<a class="headerlink" href="#Visualization-Methods" title="Link to this heading">¶</a></h3>
<p>The script includes functions for visualizing the simulated data, making it easier to analyze the interdependencies and dynamics within the system.</p>
</section>
</section>
<section id="Notebook-Structure">
<h2>Notebook Structure<a class="headerlink" href="#Notebook-Structure" title="Link to this heading">¶</a></h2>
<p>This notebook will show how to simulate VAR models using the <code class="docutils literal notranslate"><span class="pre">VARsim.py</span></code> script, including specifying parameters directly in the code and importing from a JSON file. We will also explore various methods for visualizing the simulated data to derive insights into the modeled system’s dynamics.</p>
</section>
<section id="Objective">
<h2>Objective<a class="headerlink" href="#Objective" title="Link to this heading">¶</a></h2>
<p>The goal is to simulate VAR model dynamics using the <code class="docutils literal notranslate"><span class="pre">VARsim.py</span></code> class, visualize the simulated data, and understand the interactions within the VAR model with an example use-case. We aim to gain insights into the system’s dynamics through simulation and visualization techniques.</p>
<section id="Example-Usage-of-VARsim.py-VAR-Model-Simulation">
<h3>Example Usage of <code class="docutils literal notranslate"><span class="pre">VARsim.py</span></code> VAR Model Simulation<a class="headerlink" href="#Example-Usage-of-VARsim.py-VAR-Model-Simulation" title="Link to this heading">¶</a></h3>
<p>In this section, we will demonstrate the practical application of the VARsim.py class through a comprehensive example. Our goal is to provide you with a hands-on understanding of how to simulate Vector Autoregression (VAR) model dynamics, visualize the resulting data, and interpret the interactions between variables within the model. This example is designed to guide you step-by-step through the process, from setting up the simulation environment to analyzing the outcomes with visualization
techniques.</p>
</section>
<section id="Importing-Libraries">
<h3>Importing Libraries<a class="headerlink" href="#Importing-Libraries" title="Link to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mimic.model_simulate.sim_VAR</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</section>
<section id="Creating-a-VAR-simulation-model">
<h3>Creating a VAR simulation model<a class="headerlink" href="#Creating-a-VAR-simulation-model" title="Link to this heading">¶</a></h3>
<p>In this section, we are just going to create a VAR simulation model class and print the parameters it is initialized with.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">sim_VAR</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">print_parameters</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model parameters:
Model: VAR
n_obs: None
coefficients: None
initial_values: None
noise_stddev: None
output: None
</pre></div></div>
</div>
<p>We can see that the initial parameters are set to <code class="docutils literal notranslate"><span class="pre">null</span></code>. If we create a VAR model or a gMLV model, the initial parameters are going to be different for each model. However, a VAR model is going to have the following parameters: - <strong>n_obs</strong>: Number of observations to generate. - <strong>coefficients</strong>: Coefficient matrix for the VAR(1) process. It should be a square matrix of shape (n, n). - <strong>initial_values</strong>: Initial values for the process, a vector of shape (n,). - <strong>noise_stddev</strong>: Standard
deviation of the noise term. - <strong>output</strong>: This is a string that specifies the output format. It can be either <code class="docutils literal notranslate"><span class="pre">show</span></code>, <code class="docutils literal notranslate"><span class="pre">save</span></code> or <code class="docutils literal notranslate"><span class="pre">both</span></code>. If it is <code class="docutils literal notranslate"><span class="pre">show</span></code>, the plot is going to be displayed on the screen. If it is <code class="docutils literal notranslate"><span class="pre">save</span></code>, the plot is going to be saved in the current working directory. If it is <code class="docutils literal notranslate"><span class="pre">both</span></code>, the plot is going to be displayed on the screen and saved in the current working directory.</p>
<p>In the following section, we are going to specify the parameters we want to use in our simulation.</p>
</section>
<section id="Running-the-Simulation-with-Specified-Parameters">
<h3>Running the Simulation with Specified Parameters<a class="headerlink" href="#Running-the-Simulation-with-Specified-Parameters" title="Link to this heading">¶</a></h3>
<p>In this section, we’ll demonstrate how to run a VAR simulation using specified parameters directly in the code. This approach provides a quick and flexible way to test different configurations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the simulation parameters directly</span>

<span class="c1"># Number of observations to simulate. In this example we simulate 100 observations.</span>
<span class="n">n_obs</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Coefficients for the VAR model represented as a matrix. In this example, the VAR model has 2 lags and 2 variables.</span>
<span class="n">coefficients</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]]</span>

<span class="c1"># Initial values for the VAR model, represented as a matrix. In this example, the VAR model has 2 variables so the initial values are a 2x1 matrix.</span>
<span class="n">initial_values</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]</span>

<span class="c1"># Standard deviation of the noise term in the VAR model. In this example, the noise term has a standard deviation of 1.</span>
<span class="n">noise_stddev</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># Determines how the output should be handled. If &#39;show&#39;, the output is printed to the console. If &#39;save&#39;, the output is saved to a file. If &#39;none&#39;, the output is not printed or saved. If &#39;both&#39;, the output is printed and saved.</span>
<span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;show&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># now we can set the parameters for our VAR model created previously</span>
<span class="n">model</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">n_obs</span><span class="o">=</span><span class="n">n_obs</span><span class="p">,</span> <span class="n">coefficients</span><span class="o">=</span><span class="n">coefficients</span><span class="p">,</span>
                     <span class="n">initial_values</span><span class="o">=</span><span class="n">initial_values</span><span class="p">,</span> <span class="n">noise_stddev</span><span class="o">=</span><span class="n">noise_stddev</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate the data. The data is simulated by calling the run method of the sim_VAR object and passing the name of the simulation method as an argument. In this example, the simulation method is &#39;VARsim&#39;.</span>
<span class="n">model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="s2">&quot;VARsim&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Using the following parameters for VAR simulation: {&#39;n_obs&#39;: 100, &#39;coefficients&#39;: array([[ 0.8, -0.2],
       [ 0.3,  0.5]]), &#39;initial_values&#39;: array([[1],
       [2]]), &#39;noise_stddev&#39;: 1.0, &#39;output&#39;: &#39;show&#39;}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_VAR_examples-sim-VAR_10_1.png" src="../../_images/notebooks_VAR_examples-sim-VAR_10_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The simulated data is stored in the sim_VAR object and can be accessed using the data attribute of the object.</span>
<span class="n">model</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 1.        ,  2.        ],
       [ 0.8093882 ,  2.24234669],
       [-0.58934955,  2.07364017],
       [-0.09764191,  0.98521665],
       [-1.04765057, -0.75726147],
       [-1.13406233, -1.58549792],
       [-0.64973728, -1.22203036],
       [-0.68830496, -0.79676058],
       [-2.15070241,  1.76107743],
       [-4.24327826,  0.70490676],
       [-3.90606792,  0.35228913],
       [-2.92187325, -2.46058004],
       [-1.02548479, -0.41041054],
       [-0.23512032, -0.68568214],
       [-1.50136868,  0.56573815],
       [-2.85066334, -0.29135802],
       [-0.56379734, -2.08417105],
       [-0.22853626, -3.17148826],
       [ 0.98037713, -2.51090175],
       [ 0.25046067, -1.38908553],
       [-1.26456167,  0.39502218],
       [-1.18078171,  1.21180525],
       [-1.30140217,  1.42430988],
       [-0.83009255, -1.45563366],
       [ 1.13067706, -1.14215114],
       [ 1.7575821 , -0.91397202],
       [ 2.97112607,  0.47770998],
       [ 1.86846265,  0.10762111],
       [ 3.33111999,  0.20576298],
       [ 1.90219061,  0.52576461],
       [ 1.13728423,  1.58481089],
       [ 1.04933446,  1.60808053],
       [ 0.36946315,  0.76439876],
       [-0.35586147,  2.61215567],
       [ 1.07771168,  2.76161343],
       [ 1.97602724,  0.26290791],
       [ 1.91019327, -0.27394092],
       [ 1.93984545,  0.12745739],
       [ 1.91518158, -0.9198675 ],
       [ 1.2427911 ,  1.59763585],
       [ 2.0414644 ,  1.37263105],
       [ 2.0655923 ,  0.39519291],
       [ 2.28154753,  0.71800212],
       [ 3.14269013,  0.55212722],
       [ 1.84291348,  0.89385214],
       [-0.28196928,  2.43051088],
       [-0.73309384,  0.42135586],
       [-2.13262922, -1.77299827],
       [-1.77085268, -2.66819536],
       [-1.94346104, -1.59371675],
       [-2.29982838, -0.18443354],
       [-0.59425022, -0.9533923 ],
       [-0.85479119, -0.23735167],
       [ 0.62467523, -0.27638341],
       [ 0.39574104, -0.62641682],
       [ 0.01392195, -0.27658502],
       [-0.62898762,  0.05713162],
       [ 1.07043435,  0.92439985],
       [ 0.04475511,  0.09212804],
       [ 0.35187798, -1.02177799],
       [-1.47883548,  0.44757627],
       [-1.39279857, -0.71739262],
       [-0.66914534, -0.35368738],
       [-0.43161414, -0.03408332],
       [ 0.89715929, -1.57830239],
       [ 3.37276957, -1.89153836],
       [ 3.18158822,  0.49494532],
       [ 3.26807853,  0.57986327],
       [ 3.61931123,  2.05019671],
       [ 2.84485307,  3.89677475],
       [ 1.68305286,  2.24293798],
       [ 1.77045757,  1.17674028],
       [ 2.48484848,  0.91711633],
       [ 1.61654471,  3.175619  ],
       [-0.26092364,  1.94893128],
       [-0.21791681, -0.60945956],
       [ 0.60167395,  0.2457652 ],
       [ 0.77082062, -1.25239792],
       [ 0.94835472, -0.06921799],
       [-0.26881958, -1.13974835],
       [ 1.17142044, -0.13301352],
       [ 0.83677053, -1.05145638],
       [-0.12882482,  0.14178902],
       [-0.76029806,  1.24625656],
       [-1.13415729,  0.595779  ],
       [-0.05747409, -0.17261199],
       [ 0.7505044 , -0.05090913],
       [ 0.81099874,  0.6677493 ],
       [ 0.35095274, -0.2814034 ],
       [-1.31950113, -1.1494864 ],
       [-1.93229002, -2.93158122],
       [ 0.53905692, -1.7332172 ],
       [ 0.98623003, -1.31482049],
       [ 0.90928423,  1.45185342],
       [-0.01067594,  0.31299256],
       [-0.53757832,  1.05078796],
       [-2.43511476, -0.43405256],
       [-1.33514516, -1.6293625 ],
       [-1.06011206, -1.27172062],
       [-1.47794078, -1.68671162]])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The simulated data can be saved to a file by calling the save method of the sim_VAR object and passing the name of the file as an argument. In this example, the file is saved as &#39;simulated_data.csv&#39;.</span>
<span class="n">model</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;./simulated_data.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># You can also access the simulation parameters using the print_params method of the sim_VAR object.</span>
<span class="n">model</span><span class="o">.</span><span class="n">print_parameters</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model parameters:
Model: VAR
n_obs: 100
coefficients: [[ 0.8 -0.2]
 [ 0.3  0.5]]
initial_values: [[1]
 [2]]
noise_stddev: 1.0
output: show
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># as well as the parameters</span>
<span class="n">model</span><span class="o">.</span><span class="n">save_parameters</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;./simulated_parameters.json&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># If no coefficients are specified, the default values are used</span>
<span class="c1"># for example, in this example the noise and coefficients are not specified</span>


<span class="n">simulator</span> <span class="o">=</span> <span class="n">sim_VAR</span><span class="p">()</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">n_obs</span><span class="o">=</span><span class="n">n_obs</span><span class="p">,</span> <span class="n">initial_values</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;show&#39;</span><span class="p">)</span>


<span class="n">simulator</span><span class="o">.</span><span class="n">print_parameters</span><span class="p">()</span>

<span class="n">simulator</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="s2">&quot;VARsim&quot;</span><span class="p">)</span>

<span class="n">simulator</span><span class="o">.</span><span class="n">print_parameters</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model parameters:
Model: VAR
n_obs: 100
coefficients: None
initial_values: [[1]
 [2]]
noise_stddev: None
output: show
coefficientsM: None
initial_valuesM: None
Warning: Missing or None parameters for VAR simulation. Using default values for: [&#39;coefficients&#39;, &#39;noise_stddev&#39;]
Using the following parameters for VAR simulation: {&#39;n_obs&#39;: 100, &#39;coefficients&#39;: [[0.8, -0.2], [0.3, 0.5]], &#39;initial_values&#39;: array([[1],
       [2]]), &#39;noise_stddev&#39;: 1, &#39;output&#39;: &#39;show&#39;}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_VAR_examples-sim-VAR_15_1.png" src="../../_images/notebooks_VAR_examples-sim-VAR_15_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model parameters:
Model: VAR
n_obs: 100
coefficients: [[0.8, -0.2], [0.3, 0.5]]
initial_values: [[1]
 [2]]
noise_stddev: 1
output: show
</pre></div></div>
</div>
<p>The simulator can also be run using parameters saved in a json file, which is useful for managing and reusing configurations, especially if the matrices are big. We’ll demonstrate this approach in the next section.</p>
<p>For example, you could specify the parameters in the following way:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;n_obs&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">97</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;coefficients&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">[</span>
<span class="w">            </span><span class="mf">0.8</span><span class="p">,</span>
<span class="w">            </span><span class="mf">-0.2</span><span class="p">,</span>
<span class="w">            </span><span class="mf">0.3</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="p">[</span>
<span class="w">            </span><span class="mf">0.3</span><span class="p">,</span>
<span class="w">            </span><span class="mf">0.5</span><span class="p">,</span>
<span class="w">            </span><span class="mf">-1.0</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="p">[</span>
<span class="w">            </span><span class="mf">0.2</span><span class="p">,</span>
<span class="w">            </span><span class="mf">-0.1</span><span class="p">,</span>
<span class="w">            </span><span class="mf">0.4</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;initial_values&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">[</span>
<span class="w">            </span><span class="mi">1</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="p">[</span>
<span class="w">            </span><span class="mi">2</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="p">[</span>
<span class="w">            </span><span class="mi">0</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;noise_stddev&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;output&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;both&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">read_parameters</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;./parameters2.json&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">print_parameters</span><span class="p">()</span>

<span class="n">model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="s2">&quot;VARsim&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model parameters:
Model: VAR
n_obs: 97
coefficients: [[ 0.8 -0.2  0.3]
 [ 0.3  0.5 -1. ]
 [ 0.2 -0.1  0.4]]
initial_values: [[1]
 [2]
 [0]]
noise_stddev: 1.2
output: show
Using the following parameters for VAR simulation: {&#39;n_obs&#39;: 97, &#39;coefficients&#39;: array([[ 0.8, -0.2,  0.3],
       [ 0.3,  0.5, -1. ],
       [ 0.2, -0.1,  0.4]]), &#39;initial_values&#39;: array([[1],
       [2],
       [0]]), &#39;noise_stddev&#39;: 1.2, &#39;output&#39;: &#39;show&#39;}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_VAR_examples-sim-VAR_17_1.png" src="../../_images/notebooks_VAR_examples-sim-VAR_17_1.png" />
</div>
</div>
<p>The script also contains different methods for visualizing the simulated data, including plotting the time series of each variable in a different plot.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">make_plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_VAR_examples-sim-VAR_19_0.png" src="../../_images/notebooks_VAR_examples-sim-VAR_19_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">make_plot_overlay</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_VAR_examples-sim-VAR_20_0.png" src="../../_images/notebooks_VAR_examples-sim-VAR_20_0.png" />
</div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">MIMIC</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../readme.html">Modelling and Inference of MICrobiomes Project (MIMIC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">mimic</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../MultiModel/Herold/examples-Herold.html">Using the Data Imputator on a Real Public Dataset, Herold et al. (2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MultiModel/Herold/examples-Herold.html#Separate-the-data-into-MG-and-MT-datasets">Separate the data into MG and MT datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MultiModel/Herold/examples-Herold-Metabolites.html">Using the Data Imputator on a Real Public Dataset, Herold et al. (2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MultiModel/Herold/examples-Herold-Metabolites.html#Separate-the-data-into-MG-and-MT-datasets">Separate the data into MG and MT datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gMLV/examples-sim-gMLV.html">Simulate some time course data from the gMLV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gMLV/examples-ridge-lasso-gMLV.html">Run ridge regression and lasso for the gMLV model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MVAR/examples-infer-MVAR.html">MVAR Simulation for Microbiota and Metabolites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MVAR/examples-sim-MVAR.html">MVAR Simulation for Microbiota and Metabolites</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Vector AutoRegression (VAR) Simulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Notebook-Structure">Notebook Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Objective">Objective</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples-bayes-VAR.html">Bayesian Inference for Vector AutoRegression (VAR) Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gLV/examples-Stein.html">Repeat Stein et al. 2013 analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gLV/examples-bayes-gLV.html">Used Bayesian inference to infer the parameters of a (linearised) gLV model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gLV/examples-lasso-gLV.html">Comparison of ridge vs lasso regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gLV/examples-sim-gLV.html">Simulate some time course data from the gLV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gLV/examples-ridge-gLV.html">Simulate some time course data and perform ridge regression as in Stein et al. 2013</a></li>
<li class="toctree-l2"><a class="reference internal" href="../GP/examples-impute-GP_Stein.html">Using the Data Imputator on a Real Public Dataset - Stein et al. (2013)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../GP/examples-impute-GP.html">Imputing Missing Values using Gaussian Process</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to MIMIC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../history.html">History</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../../examples.html">Examples</a><ul>
      <li>Previous: <a href="../MVAR/examples-sim-MVAR.html" title="previous chapter">MVAR Simulation for Microbiota and Metabolites</a></li>
      <li>Next: <a href="examples-bayes-VAR.html" title="next chapter">Bayesian Inference for Vector AutoRegression (VAR) Models</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Pedro Fontanarrosa.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../_sources/notebooks/VAR/examples-sim-VAR.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>